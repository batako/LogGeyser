{{- $isoTime := "2006-01-02T15:04:05-07:00" -}}
{{- printf "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" | safeHTML -}}
{{- printf "<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n" | safeHTML -}}
{{- with .Site.Home -}}
  {{- $loc := .Permalink | htmlEscape -}}
  {{- $lastmod := .Lastmod.Format $isoTime | htmlEscape -}}
  {{- printf "  <url>\n    <loc>%s</loc>\n    <lastmod>%s</lastmod>\n    <priority>1.0</priority>\n  </url>\n" $loc $lastmod | safeHTML -}}
{{- end -}}
{{- range .Site.RegularPages -}}
  {{- $loc := .Permalink | htmlEscape -}}
  {{- $lastmod := .Lastmod.Format $isoTime | htmlEscape -}}
  {{- printf "  <url>\n    <loc>%s</loc>\n    <lastmod>%s</lastmod>\n" $loc $lastmod | safeHTML -}}
  {{- with .Params.priority -}}
    {{- printf "    <priority>%.1f</priority>\n" . | safeHTML -}}
  {{- else -}}
    {{- printf "    <priority>0.5</priority>\n" | safeHTML -}}
  {{- end -}}
  {{- with .Params.changefreq -}}
    {{- $freq := . | htmlEscape -}}
    {{- printf "    <changefreq>%s</changefreq>\n" $freq | safeHTML -}}
  {{- end -}}
  {{- printf "  </url>\n" | safeHTML -}}
{{- end -}}
{{- printf "</urlset>\n" | safeHTML -}}
